      subroutine LWW90_F2(X,Q2,TG,MODEL,F2,ST,SY,SLP,DSLP,success)
      real X,Q2,F2,ST,SY,SLP,DSLP
      integer TG,MODEL,success
      
      real B(2,9)
      
      real B1(9) /0.7338659870E0,  11.0245522588E0,  2.6185804129E0,
     c     4.0956321483E0,   0.1206495422E0,  1.9714128709E0,
     c     3.8893348719E0, -14.0507358314E0,  8.8080576075E0/
      
      real B2(9) /0.6087459014E0,   8.4283440045E0,  1.8643042857E0,
     c     3.1298831009E0,   0.1952690820E0,  0.8207482504E0,
     c     3.2808011387E0,  -8.2972794804E0,  4.4892920417E0/
      
      real L(2,9,9)
      
      real L11(9) /0.0006676790E0,  0.0088218048E0, -0.0007305188E0,
     c     -0.0015980319E0,  0.0000814499E0,  0.0022889591E0,
     c     -0.0153597481E0,  0.0257681937E0, -0.0129827203E0/
      
      real L12(9) /0.0088218048E0,  0.4084284036E0,  0.0479735629E0,
     c     0.0472083864E0,  0.0007306896E0, -0.0267770531E0, 
     c     0.0663676188E0, -0.1319505427E0,  0.1028644511E0/
      
      real L13(9) /-0.0007305188E0,  0.0479735629E0,  0.0141871362E0,
     c     0.0188269696E0, -0.0000772884E0, -0.0209539831E0,
     c     0.1024234116E0, -0.1688799776E0,  0.0910043198E0/
      
      real L14(9) /-0.0015980319E0,  0.0472083864E0,  0.0188269696E0,
     c     0.0264316633E0, -0.0001541384E0, -0.0321703747E0,
     c     0.1590906780E0, -0.2577418883E0,  0.1356424745E0/
      
      real L15(9) /0.0000814499E0,  0.0007306896E0, -0.0000772884E0,
     c     -0.0001541384E0,  0.0021536048E0, -0.0190110257E0,
     c     0.0585567801E0, -0.0758507669E0,  0.0352107941E0/
      
      real L16(9) /0.0022889591E0, -0.0267770531E0, -0.0209539831E0,
     c     -0.0321703747E0, -0.0190110257E0,  0.2220310596E0,
     c     -0.7858318126E0,  1.0974127015E0, -0.5309260823E0/
      
      real L17(9) /-0.0153597481E0,  0.0663676188E0,  0.1024234116E0,
     c     0.1590906780E0,  0.0585567801E0, -0.7858318126E0,
     c     2.9565217889E0, -4.2563361422E0,  2.0922424569E0/
      
      real L18(9) /0.0257681937E0, -0.1319505427E0, -0.1688799776E0,
     c     -0.2577418883E0, -0.0758507669E0,  1.0974127015E0,
     c     -4.2563361422E0,  6.2376383315E0, -3.1028661049E0/
      
      real L19(9) /-0.0129827203E0,  0.1028644511E0,  0.0910043198E0,
     c     0.1356424745E0,  0.0352107941E0, -0.5309260823E0,
     c     2.0922424569E0, -3.1028661049E0,  1.5586723492E0/
      
      real L21(9) /0.0004823134E0,  0.0055128707E0, -0.0003158223E0,
     c		  -0.0008664550E0,  0.0000058824E0,  0.0013253049E0,
     c		  -0.0072791640E0,  0.0109300741E0, -0.0049461930E0/
      real L22(9) /0.0055128707E0,  0.2107333442E0,  0.0259720298E0,
     c		   0.0248189032E0,  0.0007144468E0, -0.0145424906E0,
     c		   0.0405570442E0, -0.0721227448E0,  0.0486265355E0/
      real L23(9) /-0.0003158223E0,  0.0259720298E0,  0.0068492388E0,
     c		   0.0088813426E0,  0.0001809208E0, -0.0091545289E0,
     c		   0.0388897684E0, -0.0588631696E0,  0.0295266467E0/
      real L24(9) /-0.0008664550E0,  0.0248189032E0,  0.0088813426E0,
     c		   0.0124007760E0,  0.0002241085E0, -0.0138537368E0,
     c		   0.0599295961E0, -0.0889074149E0,  0.0432637631E0/
      real L25(9) /0.0000058824E0,  0.0007144468E0,  0.0001809208E0,
     c		   0.0002241085E0,  0.0010114008E0, -0.0090339302E0,
     c		   0.0277972497E0, -0.0356355323E0,  0.0162553516E0/
      real L26(9) /0.0013253049E0, -0.0145424906E0, -0.0091545289E0,
     c		  -0.0138537368E0, -0.0090339302E0,  0.0957852750E0,
     c		  -0.3188133729E0,  0.4239206981E0, -0.1961729663E0/
      real L27(9) /-0.0072791640E0,  0.0405570442E0,  0.0388897684E0,
     c		   0.0599295961E0,  0.0277972497E0, -0.3188133729E0,
     c		   1.1017824091E0, -1.4925639539E0,  0.6968068686E0/
      real L28(9) /0.0109300741E0, -0.0721227448E0, -0.0588631696E0,
     c		  -0.0889074149E0, -0.0356355323E0,  0.4239206981E0,
     c		  -1.4925639539E0,  2.0479986415E0, -0.9652124406E0/
      real L29(9) /-0.0049461930E0,  0.0486265355E0,  0.0295266467E0,
     c		   0.0432637631E0,  0.0162553516E0, -0.1961729663E0,
     c		   0.6968068686E0, -0.9652124406E0,  0.4591313874E0/
      
      real C(2,12)
      real C1(12) /1.4168453160E0, -0.1076464631E0,  1.4864087376E0,
     c	   -5.9785594887E0,  3.5240257602E0, -0.0106079410E0,
     c	   -0.6190282831E0,  1.3852434724E0,  0.2695209475E0,
     c	   -2.1790402676E0,  4.7223977551E0, -4.3633393929E0/
      real C2(12) /0.9483220437E0, -0.1153382195E0,  1.8614034534E0,
     c	   -4.7333791157E0,  2.3483754563E0, -0.0651156444E0,
     c	   -0.2243092198E0,  1.0850340284E0,  0.2125643792E0,
     c	   -1.6872146840E0,  3.4085883231E0, -3.2545701111E0 /
      real M(2,12,12)
      real M11(12) /0.0014961921E0, -0.0114525491E0,  0.0302843702E0,
     c     -0.0334635318E0,  0.0132208899E0,  0.0000371728E0,
     c     -0.0004173300E0,  0.0007986253E0,  0.0000132630E0,
     c     -0.0000712621E0, -0.0001056593E0,  0.0004288772E0/
      real M12(12) /-0.0114525491E0,  0.0967765603E0, -0.2740561190E0,
     c	 	   0.3184559770E0, -0.1307971364E0, -0.0011246012E0,
     c		   0.0095305519E0, -0.0155069847E0, -0.0010495929E0,
     c		   0.0090797755E0, -0.0200963251E0,  0.0116773587E0/
      real M13(12) /0.0302843702E0, -0.2740561190E0,  0.8159191015E0,
     c     -0.9844443599E0,  0.4163716693E0,  0.0049245087E0,
     c     -0.0379185977E0,  0.0567662659E0,  0.0051689160E0,
     c     -0.0439817571E0,  0.0995835938E0, -0.0638367188E0/
      real M14(12) /-0.0334635318E0,  0.3184559770E0, -0.9844443599E0,
     c     1.2221697276E0, -0.5286404057E0, -0.0072551971E0,
     c     0.0521650844E0, -0.0735924860E0, -0.0082081518E0,
     c     0.0683850387E0, -0.1551044074E0,  0.1026791211E0/
      real M15(12) /0.0132208899E0, -0.1307971364E0,  0.4163716693E0,
     c     -0.5286404057E0,  0.2327515525E0,  0.0034606631E0,
     c     -0.0235526467E0,  0.0317074158E0,  0.0041807175E0,
     c     -0.0342135427E0,  0.0775630764E0, -0.0522714782E0/
      real M16(12) /0.0000371728E0, -0.0011246012E0,  0.0049245087E0,
     c     -0.0072551971E0,  0.0034606631E0,  0.0006331410E0,
     c     -0.0035750486E0,  0.0043493144E0,  0.0005207326E0,
     c     -0.0035419381E0,  0.0068329087E0, -0.0038428417E0/
      real M17(12) /-0.0004173300E0,  0.0095305519E0, -0.0379185977E0,
     c     0.0521650844E0, -0.0235526467E0, -0.0035750486E0,
     c     0.0234071623E0, -0.0312734982E0, -0.0029088270E0,
     c     0.0220336426E0, -0.0446325428E0,  0.0252355182E0/
      real M18(12) /0.0007986253E0, -0.0155069847E0,  0.0567662659E0,
     c     -0.0735924860E0,  0.0317074158E0,  0.0043493144E0,
     c     -0.0312734982E0,  0.0455043874E0,  0.0034940236E0,
     c     -0.0283748709E0,  0.0601210472E0, -0.0342674110E0/
      real M19(12) /0.0000132630E0, -0.0010495929E0,  0.0051689160E0,
     c     -0.0082081518E0,  0.0041807175E0,  0.0005207326E0,
     c     -0.0029088270E0,  0.0034940236E0,  0.0007624603E0,
     c     -0.0058108049E0,  0.0129263887E0, -0.0087097278E0/
      real M110(12) /-0.0000712621E0,  0.0090797755E0, -0.0439817571E0,
     c     0.0683850387E0, -0.0342135427E0, -0.0035419381E0,
     c     0.0220336426E0, -0.0283748709E0, -0.0058108049E0,
     c     0.0487297250E0, -0.1154000355E0,  0.0812897233E0/
      real M111(12) /-0.0001056593E0, -0.0200963251E0,  0.0995835938E0,
     c     -0.1551044074E0,  0.0775630764E0,  0.0068329087E0,
     c     -0.0446325428E0,  0.0601210472E0,  0.0129263887E0,
     c     -0.1154000355E0,  0.2885784358E0, -0.2128276155E0/
      real M112(12) /0.0004288772E0,  0.0116773587E0, -0.0638367188E0,
     c     0.1026791211E0, -0.0522714782E0, -0.0038428417E0,
     c     0.0252355182E0, -0.0342674110E0, -0.0087097278E0,
     c     0.0812897233E0, -0.2128276155E0,  0.1642123699E0/
      
      real M21(12) /0.0007144431E0, -0.0055332437E0,  0.0148345485E0,
     c     -0.0166543296E0,  0.0066913067E0, -0.0000063353E0,
     c     -0.0000313908E0,  0.0001476921E0, -0.0000519937E0,
     c     0.0004518877E0, -0.0011993941E0,  0.0010410232E0/
      real M22(12) /-0.0055332437E0,  0.0464241060E0, -0.1316100281E0,
     c     0.1539289430E0, -0.0638038463E0, -0.0004724619E0,
     c     0.0037853638E0, -0.0060936945E0, -0.0000911765E0,
     c     0.0007345446E0, -0.0009520769E0, -0.0006845386E0/
      real M23(12) /0.0148345485E0, -0.1316100281E0,  0.3889562708E0,
     c     -0.4695521254E0,  0.1995114383E0,  0.0024459109E0,
     c     -0.0172286634E0,  0.0247997549E0,  0.0014795243E0,
     c     -0.0120036957E0,  0.0259982755E0, -0.0151245338E0/
      real M24(12) /-0.0166543296E0,  0.1539289430E0, -0.4695521254E0,
     c     0.5810365405E0, -0.2518031702E0, -0.0037864499E0,
     c     0.0248168137E0, -0.0334709127E0, -0.0029341015E0,
     c     0.0235187814E0, -0.0525907667E0,  0.0342155275E0/
      real M25(12) /0.0066913067E0, -0.0638038463E0,  0.1995114383E0,
     c     -0.2518031702E0,  0.1108885979E0,  0.0018333157E0,
     c     -0.0113882800E0,  0.0146376694E0,  0.0016469653E0,
     c     -0.0130947155E0,  0.0297048474E0, -0.0201812916E0/
      real M26(12) /-0.0000063353E0, -0.0004724619E0,  0.0024459109E0,
     c     -0.0037864499E0,  0.0018333157E0,  0.0005976780E0,
     c     -0.0033294157E0,  0.0040280997E0,  0.0004270733E0,
     c     -0.0027573603E0,  0.0049156906E0, -0.0024136903E0/
      real M27(12) /-0.0000313908E0,  0.0037853638E0, -0.0172286634E0,
     c     0.0248168137E0, -0.0113882800E0, -0.0033294157E0,
     c     0.0207148104E0, -0.0268964589E0, -0.0023283682E0,
     c     0.0162308979E0, -0.0297645179E0,  0.0142701075E0/
      real M28(12) /0.0001476921E0, -0.0060936945E0,  0.0247997549E0,
     c     -0.0334709127E0,  0.0146376694E0,  0.0040280997E0,
     c     -0.0268964589E0,  0.0372995011E0,  0.0027664597E0,
     c     -0.0203157999E0,  0.0385356275E0, -0.0183131702E0/
      real M29(12) /-0.0000519937E0, -0.0000911765E0,  0.0014795243E0,
     c     -0.0029341015E0,  0.0016469653E0,  0.0004270733E0,
     c     -0.0023283682E0,  0.0027664597E0,  0.0005581515E0,
     c     -0.0041387256E0,  0.0089984380E0, -0.0059280886E0/
      real M210(12) /0.0004518877E0,  0.0007345446E0, -0.0120036957E0,
     c     0.0235187814E0, -0.0130947155E0, -0.0027573603E0,
     c     0.0162308979E0, -0.0203157999E0, -0.0041387256E0,
     c     0.0334835563E0, -0.0777433187E0,  0.0540437564E0/
      real M211(12) /-0.0011993941E0, -0.0009520769E0,  0.0259982755E0,
     c     -0.0525907667E0,  0.0297048474E0,  0.0049156906E0,
     c     -0.0297645179E0,  0.0385356275E0,  0.0089984380E0,
     c     -0.0777433187E0,  0.1924237194E0, -0.1418467794E0/
      real M212(12) /0.0010410232E0, -0.0006845386E0, -0.0151245338E0,
     c     0.0342155275E0, -0.0201812916E0, -0.0024136903E0,
     c     0.0142701075E0, -0.0183131702E0, -0.0059280886E0,
     c     0.0540437564E0, -0.1418467794E0,  0.1109342554E0/
      
      real tmp,BINDING
      real XPP,XP,Y,POLY,F2B,V(9),POL1,STB
      real Q,QTH,DQ,F2TH,QUAD,LIN,SCB,F2L,Z(12),STL
      real SLOPE,U(12),DSLOPE,SYS
      integer j,k,i
      success=0
      BINDING=1.
      STB=0.
      qUAD=0.
      STL=0.
      DSLOPE=0.
      
      

      do i=1,9
         B(1,i)=B1(i)
         B(2,i)=B2(i)
         L(1,1,i)=L11(i)
         L(1,2,i)=L12(i)
         L(1,3,i)=L13(i)
         L(1,4,i)=L14(i)
         L(1,5,i)=L15(i)
         L(1,6,i)=L16(i)
         L(1,7,i)=L17(i)
         L(1,8,i)=L18(i)
         L(1,9,i)=L19(i)
         L(2,1,i)=L21(i)
         L(2,2,i)=L22(i)
         L(2,3,i)=L23(i)
         L(2,4,i)=L24(i)
         L(2,5,i)=L25(i)
         L(2,6,i)=L26(i)
         L(2,7,i)=L27(i)
         L(2,8,i)=L28(i)
         L(2,9,i)=L29(i)
      enddo
      
      do i=1,12
         C(1,i)=C1(i)
         C(2,i)=C2(i)
         M(1,1,i)=M11(i)
         M(1,2,i)=M12(i)
         M(1,3,i)=M13(i)
         M(1,4,i)=M14(i)
         M(1,5,i)=M15(i)
         M(1,6,i)=M16(i)
         M(1,7,i)=M17(i)
         M(1,8,i)=M18(i)
         M(1,9,i)=M19(i)
         M(1,10,i)=M110(i)
         M(1,11,i)=M111(i)
         M(1,12,i)=M112(i)
         M(2,1,i)=M21(i)
         M(2,2,i)=M22(i)
         M(2,3,i)=M23(i)
         M(2,4,i)=M24(i)
         M(2,5,i)=M25(i)
         M(2,6,i)=M26(i)
         M(2,7,i)=M27(i)
         M(2,8,i)=M28(i)
         M(2,9,i)=M29(i)
         M(2,10,i)=M210(i)
         M(2,11,i)=M211(i)
         M(2,12,i)=M212(i)
      enddo
      
      F2=0.
      ST=0.
      SY=0.
      SLP=0.
      DSLP=0.
      
      if ((MODEL.ne.9).and.(MODEL.ne.12)) then
         success=-1
         return
      endif
      if ((TG.ne.0).and.(TG.ne.1)) then
         success=-1
         return
      endif
      
      if(TG.eq.1) then
         tmp = 7.7E0 * (1.E0/X + 0.93828**2/Q2 - 1.E0)
         if (tmp.ge.20.) tmp=20.
         BINDING = 1.E0/(1.E0 - exp(-tmp))
      endif
      
      XPP = (Q2 + B(TG+1,1))/(Q2/X + B(TG+1,2))
      XP = (Q2 + B(TG+1,3))/(Q2/X + B(TG+1,4))
      Y = 1.E0 - XP
      POLY = B(TG+1,5)*Y**3 + B(TG+1,6)*Y**4 + B(TG+1,7)*Y**5 +
     c     B(TG+1,8)*Y**6 + B(TG+1,9)*Y**7
      F2B = X/XPP * BINDING * POLY
      
      V(1) = -F2B/XPP/(Q2/X + B(TG+1,2))
      V(2) = F2B/XPP/(Q2/X + B(TG+1,2))**2 * (Q2 + B(TG+1,1))
      POL1 = 3.E0*B(TG+1,5)*Y**2 + 4.E0*B(TG+1,6)*Y**3 +
     c     5.E0*B(TG+1,7)*Y**4 + 6.E0*B(TG+1,8)*Y**5 +
     c     7.E0*B(TG+1,9)*Y**6
      V(3) = -F2B*POL1/POLY/(Q2/X + B(TG+1,4))
      V(4) = F2B*POL1/POLY/(Q2/X + B(TG+1,4))**2 * (Q2+B(TG+1,3))
      do j=4,8
         V(j+1)=F2B/POLY*Y**(j-1)
      enddo
      do j=0,8
         do k=0,8
         STB=STB+L(TG+1,j+1,k+1)*V(j+1)*V(k+1)
         enddo
      enddo
      STB = sqrt(STB) * BINDING
      
      Y = 1.E0 - X
      Q = log(Q2)
      QTH = 2.E-1 + 3.2E0 * X
      DQ = Q - QTH
	
      F2TH = C(TG+1,1)*Y**3 + C(TG+1,2)*Y**4 + C(TG+1,3)*Y**5 +
     c     C(TG+1,4)*Y**6 + C(TG+1,5)*Y**7
      if (Q .lt. QTH) then 
         QUAD = (C(TG+1,6) + C(TG+1,7)*X + C(TG+1,8)*X**2)*DQ**2
      endif
      LIN = (C(TG+1,9) + C(TG+1,10)*X + C(TG+1,11)*X**2 + C(TG+1,12)
     c*X**3)*DQ
      SCB = 1.E0 + LIN + QUAD
      F2L = F2TH*SCB*BINDING
      
      do j=0,4
         Z(j+1)=SCB*Y**(j+3)
      enddo
      Z(6) = 0.E0
      if( Q .lt. QTH) then
         Z(6) = F2TH*DQ**2
      endif
      Z(7) = Z(6) * X
      Z(8) = Z(6) * X**2
      
      do j=8,11
         Z(j+1)=F2TH * X**(j-8) * DQ
      enddo
      do j=0,11
         do k=0,11
            STL = STL + M(TG+1,j+1,k+1) * Z(j+1) * Z(k+1)
         enddo
      enddo
      STL = sqrt(STL) * BINDING  
      SLOPE = F2TH * LIN/DQ * BINDING
      
      do j=0,4
         U(j+1)=LIN/DQ *Y**(j+3)
      enddo
      do j=5,7
         U(j+1)=0.
      enddo
      do j=8,11
         U(j+1)=Z(j+1)/DQ
      enddo
      do j=0,11
         do k=0,11
            DSLOPE = DSLOPE + M(TG+1,j+1,k+1) * U(j+1) * U(k+1)
         enddo
      enddo
      DSLOPE = sqrt(DSLOPE)
      SYS = abs(F2B - F2L)
	
      SY = SYS
      SLP = SLOPE
      DSLP = DSLOPE
      
      if(MODEL.eq. 9) then
         F2 = F2B
         ST = STB
      else
         F2 = F2L
         ST = STL
      endif
      if ((Q2.lt.0.566).or.(X.lt.0.062).or.(X.lt.Q2/(2.*0.93828*21.))
     c     .or. (X.gt.1./((3.-0.9328**2)/(Q2+1.)))) then
         success=1
      endif
      end
