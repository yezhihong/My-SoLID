
*RADIATE
      SUBROUTINE RADIATE(E,TH,W,SIGNR,SIGRAD)
C     DOES NOT INCLUDE CONTRIBUTION FROM ELASTIC SCATTERING
      IMPLICIT REAL (A-H,O-Z)
      COMMON/QFSPAR/E0,TH0,W0,Z,A,EPS,EPSD,PF,SPENCE
      ALPH=1./137.03604
      EMASS=0.511
      DEL=10.
      PI=ACOS(-1.)
      PREC=.01
      THR=TH*PI/180.
      ARG=COS(THR/2.)**2
      SPENCE=PI**2/6.-LOG(ARG)*LOG(1.-ARG)
      DO 10 NSP=1,50
 10   SPENCE=SPENCE-ARG**NSP/FLOAT(NSP)**2
!      PRINT 15,SPENCE
! 15   FORMAT(' SPENCE FUNCTION = ',1F14.9)
      QMS=4.*E*(E-W)*SIN(THR/2.)**2
      D1=(2.*ALPH/PI)*(LOG(QMS/EMASS**2)-1.)
      D2=13.*(LOG(QMS/EMASS**2)-1.)/12.-17./36.-0.5*(PI**2/6.-SPENCE)
      D2=D2*(2.*ALPH/PI)
      EBAR=SQRT(E*(E-W))
      SIGRAD=SIGNR*(1.+D2)*EXP(-D1*LOG(EBAR/DEL))
!      PRINT 20,D1,D2
! 20   FORMAT(' DELTA1 AND DELTA2 = ',2E14.6)
      X1=0.
      X2=W-DEL
      CALL ROM(X1,X2,PREC,ANS,KF)
      ANS=ANS*1.D-26
      IFLAG=0
      ERR=0.
!      PRINT 25,X1,X2,PREC,ANS,ERR
! 25   FORMAT(' X1,X2,PREC,ANS,ERR = ',5E10.3)
!      PRINT 30,KF,IFLAG
! 30   FORMAT(' KF,IFLAG = ',2I5)
      SIGRAD=SIGRAD+ANS
      RETURN
      END
